<?php
function spliceauth($strin){
  $temp = $strin;
  $temp = str_replace("&auth=" . $_GET["auth"] ,"",$temp);
  if (strpos($strin,"?auth=") !== false){
    $temp = str_replace("?auth=" . $_GET["auth"] ,"",$temp);
  }
  return $temp;
}
$SECRET = "c0f33br3wingfun";
$type = $_GET["type"];
$auth = $_GET["auth"];
if (is_null($auth)){
  echo "Error: Order was not properly authenticated";
  die();
}
$hashurl = urldecode(spliceauth($_SERVER['REQUEST_URI']));
$hash = sha1($SECRET . $hashurl);
if ($auth === $hash){
  echo "Order Sucessfully Submitted!";
  if (strtolower($type === "espresso")){
    echo "A note was left on the receipt: lasactf{3xt3nding_l3ngth}";
  }
}
else{
  echo "Error: Authentication hash does not match";
}
?>
